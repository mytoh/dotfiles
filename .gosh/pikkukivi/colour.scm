
(define-module pikkukivi.colour
  (export
    colour)
  (use gauche.process)
  (use util.list) ; slices
  (use util.match)
  (use file.util)
  (require-extension (srfi 1 13))    ; iota
  (use kirjasto.merkkijono)
  (use kirjasto.vÃ¤ri))
(select-module pikkukivi.colour)


(define (colour-numbers)
  (let ((ls (slices (iota 256) 16))
        (colour-numbers (lambda (n)
                          (display
                            (format " ~a"
                                    (concat "[38;5;" (number->string n) "m"
                                            (number->string n) "[0m" ))))))
    (newline)

    (print "system colours")
    (for-each colour-numbers
              (car ls))
    (newline)
    (newline)

    (print "other colours")
    (let loop ((l (cdr ls)))
      (cond
        ((null? l)
         '())
        (else
          (for-each colour-numbers
                    (car l))
          (newline)
          (loop (cdr l)))))))

; set blackf  (tput setaf 0); set redf    (tput setaf 1); set greenf  (tput setaf 2)
; set yellowf (tput setaf 3); set bluef   (tput setaf 4); set purplef (tput setaf 5)
; set cyanf   (tput setaf 6); set whitef  (tput setaf 7)

(define blackf  "[38;5;0m")
(define f1    "[38;5;1m")
(define f2  "[38;5;2m")
(define f3 "[38;5;3m")
(define f4   "[38;5;4m")
(define f5 "[38;5;5m")
(define f6   "[38;5;6m")
(define f7  "[38;5;7m")

(define rst "[0m")
(define bld "[1m")

(define (colour-pacman)
  (print
    #`"
    ,|f3|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„,rst   ,|f1|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„,rst    ,|f2|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„,rst    ,|f4|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„,rst    ,|f5|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„,rst    ,|f6|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„,rst
    ,|f3|â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–€,rst  ,|f1|â–„,|f7|â–ˆâ–€â–ˆ,|f1|â–ˆâ–ˆ,|f7|â–ˆâ–€â–ˆ,|f1|â–ˆâ–ˆâ–„,rst  ,|f2|â–„,|f7|â–ˆâ–€â–ˆ,|f2|â–ˆâ–ˆ,|f7|â–ˆâ–€â–ˆ,|f2|â–ˆâ–ˆâ–„,rst  ,|f4|â–„,|f7|â–ˆâ–€â–ˆ,|f4|â–ˆâ–ˆ,|f7|â–ˆâ–€â–ˆ,|f4|â–ˆâ–ˆâ–„,rst  ,|f5|â–„,|f7|â–ˆâ–€â–ˆ,|f5|â–ˆâ–ˆ,|f7|â–ˆâ–€â–ˆ,|f5|â–ˆâ–ˆâ–„,rst  ,|f6|â–„,|f7|â–ˆâ–€â–ˆ,|f6|â–ˆâ–ˆ,|f7|â–ˆâ–€â–ˆ,|f6|â–ˆâ–ˆâ–„,rst
    ,|f3|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€,rst      ,|f1|â–ˆ,|f7|â–„â–„â–ˆ,|f1|â–ˆâ–ˆ,|f7|â–„â–„â–ˆ,|f1|â–ˆâ–ˆâ–ˆ,rst  ,|f2|â–ˆ,|f7|â–„â–„â–ˆ,|f2|â–ˆâ–ˆ,|f7|â–„â–„â–ˆ,|f2|â–ˆâ–ˆâ–ˆ,rst  ,|f4|â–ˆ,|f7|â–„â–„â–ˆ,|f4|â–ˆâ–ˆ,|f7|â–„â–„â–ˆ,|f4|â–ˆâ–ˆâ–ˆ,rst  ,|f5|â–ˆ,|f7|â–„â–„â–ˆ,|f5|â–ˆâ–ˆ,|f7|â–„â–„â–ˆ,|f5|â–ˆâ–ˆâ–ˆ,rst  ,|f6|â–ˆ,|f7|â–„â–„â–ˆ,|f6|â–ˆâ–ˆ,|f7|â–„â–„â–ˆ,|f6|â–ˆâ–ˆâ–ˆ,rst
    ,|f3|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„,rst      ,|f1|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ,rst  ,|f2|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ,rst  ,|f4|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ,rst  ,|f5|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ,rst  ,|f6|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ,rst
    ,|f3|â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„â–„,rst  ,|f1|â–ˆâ–ˆâ–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–ˆâ–ˆ,rst  ,|f2|â–ˆâ–ˆâ–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–ˆâ–ˆ,rst  ,|f4|â–ˆâ–ˆâ–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–ˆâ–ˆ,rst  ,|f5|â–ˆâ–ˆâ–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–ˆâ–ˆ,rst  ,|f6|â–ˆâ–ˆâ–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–ˆâ–ˆ,rst
    ,|f3|  â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€,rst   ,|f1|â–€   â–€  â–€   â–€,rst  ,|f2|â–€   â–€  â–€   â–€,rst  ,|f4|â–€   â–€  â–€   â–€,rst  ,|f5|â–€   â–€  â–€   â–€,rst  ,|f6|â–€   â–€  â–€   â–€,rst
    ,bld
    ,|f3|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„   ,|f1|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„    ,|f2|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„    ,|f4|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„    ,|f5|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„    ,|f6|  â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„,rst
    ,bld,|f3|â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–€  ,|f1|â–„,|f7|â–ˆâ–€â–ˆ,|f1|â–ˆâ–ˆ,|f7|â–ˆâ–€â–ˆ,|f1|â–ˆâ–ˆâ–„  ,|f2|â–„,|f7|â–ˆâ–€â–ˆ,|f2|â–ˆâ–ˆ,|f7|â–ˆâ–€â–ˆ,|f2|â–ˆâ–ˆâ–„  ,|f4|â–„,|f7|â–ˆâ–€â–ˆ,|f4|â–ˆâ–ˆ,|f7|â–ˆâ–€â–ˆ,|f4|â–ˆâ–ˆâ–„  ,|f5|â–„,|f7|â–ˆâ–€â–ˆ,|f5|â–ˆâ–ˆ,|f7|â–ˆâ–€â–ˆ,|f5|â–ˆâ–ˆâ–„  ,|f6|â–„,|f7|â–ˆâ–€â–ˆ,|f6|â–ˆâ–ˆ,|f7|â–ˆâ–€â–ˆ,|f6|â–ˆâ–ˆâ–„,rst
    ,bld,|f3|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€      ,|f1|â–ˆ,|f7|â–„â–„â–ˆ,|f1|â–ˆâ–ˆ,|f7|â–„â–„â–ˆ,|f1|â–ˆâ–ˆâ–ˆ  ,|f2|â–ˆ,|f7|â–„â–„â–ˆ,|f2|â–ˆâ–ˆ,|f7|â–„â–„â–ˆ,|f2|â–ˆâ–ˆâ–ˆ  ,|f4|â–ˆ,|f7|â–„â–„â–ˆ,|f4|â–ˆâ–ˆ,|f7|â–„â–„â–ˆ,|f4|â–ˆâ–ˆâ–ˆ  ,|f5|â–ˆ,|f7|â–„â–„â–ˆ,|f5|â–ˆâ–ˆ,|f7|â–„â–„â–ˆ,|f5|â–ˆâ–ˆâ–ˆ  ,|f6|â–ˆ,|f7|â–„â–„â–ˆ,|f6|â–ˆâ–ˆ,|f7|â–„â–„â–ˆ,|f6|â–ˆâ–ˆâ–ˆ,rst
    ,bld,|f3|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„      ,|f1|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f2|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f4|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f5|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f6|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ,rst
    ,bld,|f3|â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„â–„  ,|f1|â–ˆâ–ˆâ–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–ˆâ–ˆ  ,|f2|â–ˆâ–ˆâ–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–ˆâ–ˆ  ,|f4|â–ˆâ–ˆâ–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–ˆâ–ˆ  ,|f5|â–ˆâ–ˆâ–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–ˆâ–ˆ  ,|f6|â–ˆâ–ˆâ–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–ˆâ–ˆ,rst
    ,bld,|f3|  â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€   ,|f1|â–€   â–€  â–€   â–€  ,|f2|â–€   â–€  â–€   â–€  ,|f4|â–€   â–€  â–€   â–€  ,|f5|â–€   â–€  â–€   â–€  ,|f6|â–€   â–€  â–€   â–€,rst
    "
    ))

(define (colour-invaders)
  (print
#`"
   ,|bld|,|f1|â–€â–„   â–„â–€  ,|rst|    ,|bld|,|f2|â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„â–„â–„ ,|rst|   ,|bld|,|f3|  â–„â–ˆâ–ˆâ–„  ,|rst|     ,|bld|,|f4|â–€â–„   â–„â–€  ,|rst|    ,|bld|,|f5|â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„â–„â–„ ,|rst|   ,|bld|,|f6|  â–„â–ˆâ–ˆâ–„  ,|rst|
  ,|bld|,|f1|â–„â–ˆâ–€â–ˆâ–ˆâ–ˆâ–€â–ˆâ–„ ,|rst|   ,|bld|,|f2|â–ˆâ–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–ˆ,|rst|   ,|bld|,|f3|â–„â–ˆâ–€â–ˆâ–ˆâ–€â–ˆâ–„,|rst|    ,|bld|,|f4|â–„â–ˆâ–€â–ˆâ–ˆâ–ˆâ–€â–ˆâ–„ ,|rst|   ,|bld|,|f5|â–ˆâ–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–ˆ,|rst|   ,|bld|,|f6|â–„â–ˆâ–€â–ˆâ–ˆâ–€â–ˆâ–„,|rst|
 ,|bld|,|f1|â–ˆâ–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–ˆ,|rst|   ,|bld|,|f2|â–€â–€â–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–€â–€,|rst|   ,|bld|,|f3|â–€â–€â–ˆâ–€â–€â–ˆâ–€â–€,|rst|   ,|bld|,|f4|â–ˆâ–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–ˆ,|rst|   ,|bld|,|f5|â–€â–€â–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–€â–€,|rst|   ,|bld|,|f6|â–€â–€â–ˆâ–€â–€â–ˆâ–€â–€,|rst|
 ,|bld|,|f1|â–€ â–€â–„â–„ â–„â–„â–€ â–€,|rst|   ,|bld|,|f2|â–„â–„â–€â–€ â–€â–€ â–€â–€â–„â–„,|rst|   ,|bld|,|f3|â–„â–€â–„â–€â–€â–„â–€â–„,|rst|   ,|bld|,|f4|â–€ â–€â–„â–„ â–„â–„â–€ â–€,|rst|   ,|bld|,|f5|â–„â–„â–€â–€ â–€â–€ â–€â–€â–„â–„,|rst|   ,|bld|,|f6|â–„â–€â–„â–€â–€â–„â–€â–„,|rst|

   ,|f1|â–€â–„   â–„â–€  ,|rst|    ,|f2|â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„â–„â–„ ,|rst|   ,|f3|  â–„â–ˆâ–ˆâ–„  ,|rst|     ,|f4|â–€â–„   â–„â–€  ,|rst|    ,|f5|â–„â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„â–„â–„ ,|rst|   ,|f6|  â–„â–ˆâ–ˆâ–„  ,|rst|
  ,|f1|â–„â–ˆâ–€â–ˆâ–ˆâ–ˆâ–€â–ˆâ–„ ,|rst|   ,|f2|â–ˆâ–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–ˆ,|rst|   ,|f3|â–„â–ˆâ–€â–ˆâ–ˆâ–€â–ˆâ–„,|rst|    ,|f4|â–„â–ˆâ–€â–ˆâ–ˆâ–ˆâ–€â–ˆâ–„ ,|rst|   ,|f5|â–ˆâ–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–ˆ,|rst|   ,|f6|â–„â–ˆâ–€â–ˆâ–ˆâ–€â–ˆâ–„,|rst|
 ,|f1|â–ˆâ–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–ˆ,|rst|   ,|f2|â–€â–€â–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–€â–€,|rst|   ,|f3|â–€â–€â–ˆâ–€â–€â–ˆâ–€â–€,|rst|   ,|f4|â–ˆâ–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€â–ˆ,|rst|   ,|f5|â–€â–€â–€â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–€â–€â–€,|rst|   ,|f6|â–€â–€â–ˆâ–€â–€â–ˆâ–€â–€,|rst|
 ,|f1|â–€ â–€â–„â–„ â–„â–„â–€ â–€,|rst|   ,|f2|â–„â–„â–€â–€ â–€â–€ â–€â–€â–„â–„,|rst|   ,|f3|â–„â–€â–„â–€â–€â–„â–€â–„,|rst|   ,|f4|â–€ â–€â–„â–„ â–„â–„â–€ â–€,|rst|   ,|f5|â–„â–„â–€â–€ â–€â–€ â–€â–€â–„â–„,|rst|   ,|f6|â–„â–€â–„â–€â–€â–„â–€â–„,|rst|


                                     ,|f7|â–Œ,|rst|

                                   ,|f7|â–Œ,|rst|
                                   ,|f7|,|rst|
                                  ,|f7|â–„â–ˆâ–„,|rst|
                              ,|f7|â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„,|rst|
                              ,|f7|â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€,|rst|

"
    ))

(define (colour-guns)
  (print
#`"
,|f1| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     ,|f2| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f3| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f4| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f5| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f6| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
,|f1| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€        ,|f2| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€       ,|f3| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€       ,|f4| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€       ,|f5| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€       ,|f6| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€
,|f1|â–â–ˆâ–ˆâ–ˆâ–„â–€            ,|f2|â–â–ˆâ–ˆâ–ˆâ–„â–€           ,|f3|â–â–ˆâ–ˆâ–ˆâ–„â–€           ,|f4|â–â–ˆâ–ˆâ–ˆâ–„â–€           ,|f5|â–â–ˆâ–ˆâ–ˆâ–„â–€           ,|f6|â–â–ˆâ–ˆâ–ˆâ–„â–€
,|f1|â–â–ˆâ–ˆâ–ˆ              ,|f2|â–â–ˆâ–ˆâ–ˆ             ,|f3|â–â–ˆâ–ˆâ–ˆ             ,|f4|â–â–ˆâ–ˆâ–ˆ             ,|f5|â–â–ˆâ–ˆâ–ˆ             ,|f6|â–â–ˆâ–ˆâ–ˆ
,|f1| â–€â–€â–€              ,|f2| â–€â–€â–€             ,|f3| â–€â–€â–€             ,|f4| â–€â–€â–€             ,|f5| â–€â–€â–€             ,|f6| â–€â–€â–€
,|bld|
,|f1|  â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f2| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f3| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f4| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f5| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  ,|f6| â–€â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
,|f1| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€        ,|f2| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€       ,|f3| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€       ,|f4| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€       ,|f5| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€       ,|f6| â–„â–ˆâ–ˆâ–ˆâ–€â–ˆâ–€â–€â–€
,|f1|â–â–ˆâ–ˆâ–ˆâ–„â–€            ,|f2|â–â–ˆâ–ˆâ–ˆâ–„â–€           ,|f3|â–â–ˆâ–ˆâ–ˆâ–„â–€           ,|f4|â–â–ˆâ–ˆâ–ˆâ–„â–€           ,|f5|â–â–ˆâ–ˆâ–ˆâ–„â–€           ,|f6|â–â–ˆâ–ˆâ–ˆâ–„â–€
,|f1|â–â–ˆâ–ˆâ–ˆ              ,|f2|â–â–ˆâ–ˆâ–ˆ             ,|f3|â–â–ˆâ–ˆâ–ˆ             ,|f4|â–â–ˆâ–ˆâ–ˆ             ,|f5|â–â–ˆâ–ˆâ–ˆ             ,|f6|â–â–ˆâ–ˆâ–ˆ
,|f1| â–€â–€â–€              ,|f2| â–€â–€â–€             ,|f3| â–€â–€â–€             ,|f4| â–€â–€â–€             ,|f5| â–€â–€â–€             ,|f6| â–€â–€â–€
"
    ))


(define (spect-system-colours)
  (print "System colors")
  (for-each
    (lambda (s)
      (display
        (format "[48;5;~Am  " s)))
    (iota 8))
  (display "[0m")
  (newline)
  (for-each
    (lambda (s)
      (display
        (format "[48;5;~Am  " s)))
    (iota 8 8))
  (display "[0m")
  (newline))

(define (spect-colour-cube)
  (newline)
  (print "Colour cube, 6x6x6:")
  (let ((ls (iota 6)))
    (for-each
      (lambda (g)
        (for-each
          (lambda (r)
            (for-each
              (lambda (b)
                (display (format "[48;5;~Am  " (+ 16 (* r 36) (* g 6) b))))
              ls)
            (display "[0m "))
          ls)
        (newline))
      ls)))

(define (spect-grayscale-colours)
  (print "Grayscale ramp")
  (for-each
    (lambda (s)
      (display
        (format "[48;5;~Am  " s)))
    (let loop ((ls 232))
      (when (< ls 256)
        (cons ls (loop (+ ls 1))))
      ))
  (display "[0m")
  (newline))

(define (colour-spect)
  (spect-system-colours)
  (spect-colour-cube)
  (spect-grayscale-colours))


(define (colour-square)
  (newline)
  (dotimes (i 7)
    (display " ")
    (for-each
      (lambda (s)
        (display
          (format "[48;5;~Am     " s))
        (display "[0m "))
      (iota 8))
    (newline))
  (print "[0m")
  (dotimes (i 7)
    (display " ")
    (for-each
      (lambda (s)
        (display
          (format "[48;5;~Am     " s))
        (display "[0m "))
      (iota 8 8))
    (newline))
  (print "[0m"))

(define (colour args)
  (match (car args)
    ("numbers"
     (colour-numbers))
    ("spect"
     (colour-spect))
    ("pacman"
     (colour-pacman))
    ("invaders"
     (colour-invaders))
    ("guns"
     (colour-guns))
    ("square"
     (colour-square))))

