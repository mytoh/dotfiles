;; -*- lisp -*-

;; settings taken from "http://aperturefever.wordpress.com/2010/05/10/updating-stumpwm-conf/"

(in-package :stumpwm)

(setf *startup-message* nil)

;; hide mouse
;; (run-with-timer 5 5 'banish-pointer)

(set-font "-kochi-gothic-medium-r-normal-*-12-110-*-*-p-*-iso10646-1")
  

;;;; message window
(set-bg-color "grey20")
(set-fg-color "orange")
(set-border-color "grey10")
(set-msg-border-width 1)
(setf *message-window-gravity* :top-right
      *input-window-gravity* :bottom-left)


;; (run-shell-command " ~/.dzen/bin/status | exec dzen2 -p 1 -ta r -x 400 -y 0 -w 800 -h 16 ")
;; (run-shell-command "exec trayer --expand false --alpha 200  --tint 0x303030 --transparent true --padding 1 --margin 0 --edge bottom --align right --SetDockType true --SetPartialStrut true --heighttype pixel --height 8 --widthtype pixel --width 80 " )

(defcommand terminal () () (run-shell-command "urxvtc"))
(defcommand browser () () (run-or-raise "firefox3" '(:class "Firefox")))
(defcommand filer () () (run-or-raise "thunar" '(:class "Thunar")))
(defcommand dmenu () () (run-shell-command "dmenu_run -nb grey20 -nf orange"))

(define-key *root-map* (kbd "c") "terminal")
(define-key *root-map* (kbd "f") "browser")
(define-key *root-map* (kbd "t") "filer")
(define-key *root-map* (kbd "C-f") "fullscreen")

(define-key *top-map* (kbd "M-j") "next-in-frame")
(define-key *top-map* (kbd "M-k") "prev-in-frame")
(define-key *top-map* (kbd "M-n") "fnext")
(define-key *top-map* (kbd "M-h") "gprev")
(define-key *top-map* (kbd "M-l") "gnext")
(define-key *top-map* (kbd "M-s") "vsplit")
(define-key *top-map* (kbd "M-S") "hsplit")
(define-key *top-map* (kbd "M-R") "remove")
(define-key *top-map* (kbd "M-d") "dmenu")
(define-key *top-map* (kbd "M-TAB") "next")

(setf *mouse-focus-policy* :sloppy)

;;;; windows
(setf *normal-border-width* 1 
      *maxsize-border-width* 2
      *transient-border-width* 1
      *window-border-style* :thin) ;; thick,thin,none,tight
(set-focus-color "dimgrey")
(set-unfocus-color "grey10")
(set-normal-gravity :center)
(set-frame-outline-width 1)
(setf *new-window-preferred-frame* '(:empty :focused))

;;;; set the two remaining color slots
(setf *colors* (append *colors*
                (list "orange"  
                      "coral")))
(update-color-map (current-screen))

;; modeline
(enable-mode-line (current-screen) (current-head) t)

(setf *mode-line-background-color* "grey20"
      *mode-line-foreground-color* "orange"
      *mode-line-position* :top
      *mode-line-border-width* 1
      *mode-line-pad-x* 2
      *mode-line-pad-y* 2
      *mode-line-timeout* 1
      *window-format* "^5*(%n%s%m%15t)^n" ;;^5 magenta
      *group-format*  "^7*%t%s^n" ;;^7 white
      *screen-mode-line-format*  ;; ^n use the normal bg and fg color
      (list "%g ^9*|^n %w ^9*|^n " 
       '(:eval (run-shell-command "date +'%a %d %m %T' | tr -d '[:cntrl:]'" t))))


;;;; groups
;; rename the first group to main
;;(setf (group-name (first (screen (current-screen)))) "main")
;; create the other group
(run-commands  "gnewbg www" "gnewbg media" "gselect Default" "grename main" "gselect main")


;;;; window placement rules
;; clear rules
(clear-window-placement-rules)

(define-frame-preference "www"
;; frame raise lock (lock AND raise == jumpto)
(0 t t :class "Firefox"))

(setf *debug-level* 10)

