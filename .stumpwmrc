;; -*-lisp;stumpwm-*-
;; vim:filetype=lisp

;; settings taken from "http://aperturefever.wordpress.com/2010/05/10/updating-stumpwm-conf/"

(in-package :stumpwm)

(defparameter terminal "urxvtcd")

;; message window
(set-bg-color "grey20")
(set-fg-color "orange")
(set-border-color "grey10")
(set-msg-border-width 1)
;(set-font "-mplus-goth_p-medium-r-normal-*-10-*-*-*-*-*-iso10646-*"
(set-font "-artwiz-limemod-medium-r-normal--10-110-75-75-m-50-iso8859-1")
;; windows
(set-focus-color "khaki")
(set-unfocus-color "grey10")
(set-win-bg-color "grey20")
(set-normal-gravity :center)
(set-transient-gravity :top-right)
(set-frame-outline-width 1)

;; options
(setf
  *startup-message*                 nil
  ; border
  *normal-border-width*             1
  *maxsize-border-width*            1
  *transient-border-width*          1
  *window-border-style*             :tight ;; thick,thin,none,tight
  ; number map
  *frame-number-map*                "aoeuidhtnspyfgcrlqjkxbmwvz"
  *window-number-map*               "aoeuidhtns"
  *group-number-map*                "aoeuidhtns"
  ; focus
  *mouse-focus-policy*              :sloppy
  *run-or-raise-all-groups*         t
  *new-window-preferred-frame*      '(:empty :focused)
  ; gravity
  *message-window-gravity*          :bottom-left
  *input-window-gravity*            :bottom-left
  *input-history-ignore-duplicates* t
  ; mode-line
  *mode-line-background-color*      "grey20"
  *mode-line-foreground-color*      "DarkKhaki"
  *mode-line-border-color*          "pink"
  *mode-line-position*              :top
  *mode-line-border-width*          0
  *mode-line-pad-x*                 1
  *mode-line-pad-y*                 1
  *mode-line-timeout*               5
  ; formats
  *window-format*                   "^9*(%n%m%15t)^n" ;;^5 magenta
  *group-format*                    "^7*%t%s^n" ;;^7 white
  )


;; set color slots
 (setf *colors* (list "grey"          ; 0 black
                     "palevioletred" ; 1 red
                     "lightblue"     ; 2 green
                     "bisque"        ; 3 yellow
                     "lightskyblue"     ; 4 blue
                     "slateblue"     ; 5 magenta
                     "aquamarine"    ; 6 cyan
                     "honeydew"      ; 7 white
                     "thistle"       ; 8 user
                     "lightskyblue")); 9 user
(update-color-map (current-screen))

;; modeline
(if (not (head-mode-line (current-head)))
    (toggle-mode-line (current-screen) (current-head)))

(setf *screen-mode-line-format*  ;; ^n : normal bg and fg color
      (list "%g ^8*|^n "
            "^2*%W ^8*|^n "
            '(:eval (run-shell-command "~/.stumpwm.d/modeline.scm" t))
            "^8*|^n %d "
            ))

;; startup programmes
;(run-shell-command "exec trayer --expand true --alpha 100  --tint 0x303030 --transparent true --padding 1 --margin 0 --edge bottom --align right --SetDockType true --SetPartialStrut true --heighttype pixel --height 8 --widthtype request --width 100 " )
;(run-shell-command "stalonetray" )
(run-shell-command "exec feh --bg-scale ~/.wallpaper" )
; (run-shell-command "exec compton -i 0.9 -e 0.9" )
(run-shell-command "exec ~/.stumpwm.d/dzen.sh" )

;; groups
; rename the first group to main
;(setf (group-name (first (screen (current-screen)))) "main")
; create the other group
; gnewbg, gnewbg-float
(run-commands  "gselect Default" "grename main" "gselect main" "gnewbg web" "gnewbg-float media" )

;;;; window placement rules
(clear-window-placement-rules) ; clear rules

(define-frame-preference "web"
     ;; fnumber raise lock (lock AND raise == jumpto)
      (0 t t :class "Opera")
      (0 t t :class "Firefox"))

(define-frame-preference "media"
      (0 t t :class "Audacious")
      (0 t t :class "MPlayer")
      (0 t t :class "feh")
      (0 t t :class "jd-Main")
      )

(loop for file in '("keymaps" "hooks" "commands")
  do (load (merge-pathnames (make-pathname :name file :type "lisp"
            :directory '(:relative "conf" )) *data-dir*)))

(setf *debug-level* 10)

